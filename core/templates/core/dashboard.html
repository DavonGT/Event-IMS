{% extends 'core/base.html' %}

{% block title %}Dashboard{% endblock %}

{% block content %}

<div class="dashboard-container">

  <!-- Main Content -->
  <div class="main-content">

    <!-- Calendar -->
    <div id="calendar"></div>
  </div>

  <!-- Events Sidebar -->
  <div class="events-sidebar">
    <div class="event-box">
      <h3>FCO Events:</h3>
      <ul>
        <li>04.01.25 - <span style="font-family: cursive;">ccs feast</span></li>
      </ul>
    </div>
    <div class="event-box">
      <h3>ITSO Events:</h3>
      <ul>
        <li>No events</li>
      </ul>
    </div>
    <div class="event-box">
      <h3>CSSO Events:</h3>
      <ul>
        <li>No events</li>
      </ul>
    </div>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const calendarEl = document.getElementById('calendar');
    const eventsData = JSON.parse('{{ events_json|safe }}');

    const calendarEvents = eventsData.map(event => ({
      title: event.name,
      date: event.date
    }));

    const calendar = new FullCalendar.Calendar(calendarEl, {
      initialView: 'dayGridMonth',
      events: calendarEvents,
      headerToolbar: {
        left: 'customTitle',
        center: '',
        right: 'prev,next'
      },
      customButtons: {
        customTitle: {
          text: '',
          click: function () {}
        }
      },
      datesSet: function(info) {
        const visibleMidDate = new Date(info.start);
        visibleMidDate.setDate(visibleMidDate.getDate() + 15);

        const month = visibleMidDate.toLocaleString('default', { month: 'long' });
        const year = visibleMidDate.getFullYear();

        const customTitleEl = document.querySelector('.fc-customTitle-button');
        if (customTitleEl) {
          customTitleEl.innerHTML = `
            <span class="calendar-month">${month}</span>
            <span class="calendar-year">${year}</span>
          `;
        }
      }
    });

    calendar.render();
  });
</script>
{% endblock %}
